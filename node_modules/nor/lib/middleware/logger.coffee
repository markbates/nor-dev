sys = require 'sys'

class Nor.Middleware.Logger
  
  @process: (env) ->
    start_time = env._meta._process_start_time
    end_time = new Date()
    total_time = end_time - start_time
    message = """\n\t[#{env.method.toUpperCase()}] #{env.url} | Parameters: #{JSON.stringify(env.params)}
\tRequest Time: #{total_time}ms | Status: #{env._meta.status}
"""
    if env._meta.rendered_view_paths.length > 0
      message += " | Rendered: #{env._meta.rendered_view_paths.join(', ')}"
      
    Nor.logger.info message
    return env